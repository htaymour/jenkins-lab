//   /* scm{
//     description("Pull files from github repo when some developers push code to github")

//     git 'https://github.com/htaymour/jenkins-lab.git' --origin maain

//   } */
//   steps { 
//     script {
   
//     mail to: 'haytham.taymour@orange.com',
//     subject: "Job '${JOB_NAME}' (${BUILD_NUMBER}) is waiting for input",
//     body: "Please go to ${BUILD_URL} and verify the build"  
// }}

// ============== NOTES =============
// curl -o $WORKSPACE/ccr1 -L 'https://github.com/htaymour/jenkins-lab/blob/main/ccr/ccr1'



pipeline {
    agent none
    stages {
        stage('Download GitHub file') {
            agent any
            options {
                // Timeout counter starts BEFORE agent is allocated
                timeout(time: 100, unit: 'SECONDS')
            }
            steps {
                  echo 'Hello World !'
                  sh '''
                  pwd
                  cd ccr
                  echo 'CCR request downloaded. Showing contents of latest file :'
                  cat "$(ls -tp | grep -v / | head -n1)"
                  '''
                  def ccr_file = sh("ls -tp | grep -v / | head -n1", returnStdout: true)
                  def ccr_info = sh(" cat $(ls -tp | grep -v / | head -n1)", returnStdout: true)
                  echo "The captured file is: ${ccr_file}"
                  echo "The captured data is: ${ccr_info}"
                

            }
        }
    }
}